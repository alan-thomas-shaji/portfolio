---
/**
 * Projects Section - Featured Work
 * 
 * Showcases featured projects with Star Wars workshop aesthetic
 */

import DatacardIcon from './icons/DatacardIcon.astro';
import RebelStarbirdIcon from './icons/RebelStarbirdIcon.astro';

import falconImage from '../assets/home/falcon.png';

interface Project {
  title: string;
  description: string;
  technologies: string[];
  highlights: string[];
  link?: string;
}

const projects: Project[] = [
  {
    title: 'HLF Chat App',
    description: 'A real-time blockchain-based chat system using HyperLedger Fabric, Node JS, and React. Focus on data provenance and security.',
    technologies: ['HyperLedger Fabric', 'Node.js', 'React', 'Blockchain'],
    highlights: ['Real-time messaging', 'Blockchain security', 'Data provenance'],
  },
  {
    title: 'Resume Builder',
    description: 'A React-based web app allowing users to generate professional resumes with customizable templates.',
    technologies: ['React', 'TypeScript', 'Tailwind CSS'],
    highlights: ['Customizable templates', 'PDF generation', 'User-friendly interface'],
  },
  {
    title: 'Zoot',
    description: 'A Python-based automation tool using Selenium to automate joining and managing Zoom meetings.',
    technologies: ['Python', 'Selenium', 'Automation'],
    highlights: ['Meeting automation', 'Time-saving', 'Reliable scheduling'],
  },
];
---

<section id="projects" class="projects-section min-h-screen py-20 relative">
  <div class="workshop-background-overlay"></div>
  
  <div class="container mx-auto px-4 relative z-10">
    <div class="section-header">
      <div class="header-content">
        <div class="header-left">
          <div class="header-title-wrapper">
            <DatacardIcon class="w-10 h-10 text-workshop-orange header-icon" />
            <h2 class="text-4xl md:text-5xl font-bold text-workshop-orange font-mono">
              [FEATURED PROJECTS]
            </h2>
          </div>
          <p class="text-gray-300 text-lg max-w-2xl">
            Notable projects forged in the workshop, each representing a unique challenge and solution.
          </p>
        </div>
        <div class="header-right">
          <div class="falcon-container">
            <img 
              src={falconImage.src} 
              alt="Millennium Falcon" 
              class="falcon-image clickable-falcon"
              id="millennium-falcon"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="projects-grid">
      {projects.map((project, index) => (
        <div class={`project-card ${index % 2 === 0 ? 'card-left' : 'card-right'}`} data-project={index}>
          <div class="card-glow"></div>
          
          <div class="card-header">
            <RebelStarbirdIcon class="w-8 h-8 text-workshop-orange" />
            <div class="card-title-group">
              <h3 class="card-title">{project.title}</h3>
            </div>
          </div>

          <p class="card-description">{project.description}</p>

          <div class="card-highlights">
            <span class="highlights-label">Key Features:</span>
            <div class="highlights-list">
              {project.highlights.map((highlight) => (
                <span class="highlight-tag">{highlight}</span>
              ))}
            </div>
          </div>

          <div class="card-technologies">
            <span class="tech-label">Technologies:</span>
            <div class="tech-tags">
              {project.technologies.map((tech) => (
                <span class="tech-tag">{tech}</span>
              ))}
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .projects-section {
    background: linear-gradient(180deg, #0f0d0a 0%, #1a1612 100%);
    position: relative;
    overflow: hidden;
  }

  .workshop-background-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
      radial-gradient(circle at 30% 30%, rgba(255, 140, 0, 0.1) 0%, transparent 50%),
      radial-gradient(circle at 70% 70%, rgba(139, 69, 19, 0.1) 0%, transparent 50%);
    pointer-events: none;
  }

  .section-header {
    margin-bottom: 4rem;
    position: relative;
  }

  .header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 2rem;
    position: relative;
  }

  .header-left {
    flex: 1;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
  }

  .header-title-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
  }

  .header-icon {
    flex-shrink: 0;
  }

  .header-right {
    flex-shrink: 0;
    position: relative;
  }

  .falcon-container {
    perspective: 2000px;
    transform-style: preserve-3d;
  }

  .falcon-image {
    max-width: 200px;
    width: auto;
    height: auto;
    cursor: pointer;
    transition: transform 0.3s ease, filter 0.3s ease;
    filter: drop-shadow(0 10px 30px rgba(255, 140, 0, 0.3));
    transform-style: preserve-3d;
    transform-origin: center center;
  }

  .falcon-image:hover {
    transform: scale(1.1);
    filter: drop-shadow(0 15px 40px rgba(255, 140, 0, 0.5));
  }

  .falcon-image.flying {
    pointer-events: none;
    will-change: transform;
  }

  .projects-grid {
    display: flex;
    flex-direction: column;
    gap: 3rem;
    max-width: 1000px;
    margin: 0 auto;
  }

  .project-card {
    position: relative;
    background: rgba(30, 25, 20, 0.8);
    border: 1px solid rgba(255, 140, 0, 0.3);
    border-radius: 12px;
    padding: 2rem;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(20px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
  }

  .project-card.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .card-glow {
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(135deg, rgba(255, 140, 0, 0.4), rgba(139, 69, 19, 0.3));
    border-radius: 12px;
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: -1;
    filter: blur(8px);
  }

  .project-card:hover .card-glow {
    opacity: 1;
  }

  .project-card:hover {
    border-color: rgba(255, 140, 0, 0.6);
    transform: translateY(-5px);
    box-shadow: 0 12px 32px rgba(255, 140, 0, 0.2);
  }

  .card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid rgba(255, 140, 0, 0.3);
  }

  .card-title-group {
    flex: 1;
  }

  .card-title {
    font-size: 1.75rem;
    font-weight: bold;
    color: #ff8c00;
    margin: 0;
  }

  .card-description {
    color: #d4a574;
    line-height: 1.6;
    margin-bottom: 1.5rem;
    font-size: 1rem;
  }

  .card-highlights {
    margin-bottom: 1.5rem;
  }

  .highlights-label {
    display: block;
    font-size: 0.875rem;
    color: #ff8c00;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.75rem;
    font-family: 'Courier New', monospace;
  }

  .highlights-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .highlight-tag {
    background: rgba(255, 140, 0, 0.2);
    border: 1px solid rgba(255, 140, 0, 0.4);
    color: #ff8c00;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-family: 'Courier New', monospace;
  }

  .card-technologies {
    margin-top: 1rem;
  }

  .tech-label {
    display: block;
    font-size: 0.875rem;
    color: #d4a574;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.75rem;
    font-family: 'Courier New', monospace;
  }

  .tech-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .tech-tag {
    background: rgba(139, 69, 19, 0.3);
    border: 1px solid rgba(139, 69, 19, 0.5);
    color: #d4a574;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-family: 'Courier New', monospace;
  }

  @media (max-width: 1024px) {
    .projects-section {
      padding: 4rem 0;
    }

    .section-header {
      margin-bottom: 3rem;
    }

    .header-content {
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .header-left {
      text-align: center;
    }

    .header-right {
      margin-top: 1rem;
    }

    .falcon-image {
      max-width: 150px;
    }
  }

  @media (max-width: 768px) {
    .projects-section {
      padding: 3rem 0;
    }

    .section-header {
      margin-bottom: 2.5rem;
    }

    .section-header h2 {
      font-size: 2rem !important;
    }

    .header-icon {
      width: 2rem;
      height: 2rem;
    }

    .header-title-wrapper {
      gap: 0.75rem;
    }

    .section-header p {
      font-size: 0.9375rem;
    }

    .header-content {
      gap: 1.5rem;
    }

    .projects-grid {
      gap: 2rem;
    }

    .project-card {
      padding: 1.5rem;
    }

    .card-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .card-title {
      font-size: 1.5rem;
    }

    .card-description {
      font-size: 0.9375rem;
    }

    .highlights-label,
    .tech-label {
      font-size: 0.8125rem;
    }

    .highlight-tag,
    .tech-tag {
      font-size: 0.8125rem;
      padding: 0.1875rem 0.625rem;
    }

    .falcon-image {
      max-width: 120px;
    }
  }

  @media (max-width: 480px) {
    .projects-section {
      padding: 2.5rem 0;
    }

    .section-header {
      margin-bottom: 2rem;
    }

    .section-header h2 {
      font-size: 1.75rem !important;
    }

    .header-icon {
      width: 1.75rem;
      height: 1.75rem;
    }

    .header-title-wrapper {
      gap: 0.5rem;
    }

    .section-header p {
      font-size: 0.875rem;
    }

    .projects-grid {
      gap: 1.5rem;
    }

    .project-card {
      padding: 1.25rem;
    }

    .card-title {
      font-size: 1.25rem;
    }

    .card-description {
      font-size: 0.875rem;
    }

    .highlight-tag,
    .tech-tag {
      font-size: 0.75rem;
      padding: 0.125rem 0.5rem;
    }

    .falcon-image {
      max-width: 100px;
    }
  }
</style>

<script is:inline>
  // Scroll-triggered animations for project cards
  (function() {
    function initProjectCards() {
      const cards = document.querySelectorAll('.project-card');
      if (cards.length === 0) return;
      
      const observer = new IntersectionObserver(
        function(entries) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        },
        { threshold: 0.1 }
      );

      cards.forEach(function(card) {
        observer.observe(card);
      });
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initProjectCards);
    } else {
      initProjectCards();
    }
  })();
</script>

<script is:inline>
  // Millennium Falcon 3D Fly-Out Animation
  (function() {
    function loadAnimeJS() {
      return new Promise(function(resolve) {
        if (window.anime) {
          resolve(window.anime);
          return;
        }
        
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js';
        script.async = true;
        
        script.onload = function() {
          if (window.anime) {
            resolve(window.anime);
          } else {
            resolve(null);
          }
        };
        
        script.onerror = function() {
          resolve(null);
        };
        
        document.head.appendChild(script);
      });
    }

    function initFalconAnimation() {
      const falcon = document.getElementById('millennium-falcon');
      if (!falcon) return;

      loadAnimeJS().then(function(anime) {
        if (!anime) {
          console.warn('Anime.js not loaded, falcon animation disabled');
          return;
        }

        falcon.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          // Prevent multiple clicks
          if (falcon.classList.contains('flying')) return;
          
          falcon.classList.add('flying');
          
          // Set initial transform style for 3D
          falcon.style.transformStyle = 'preserve-3d';
          
          // Get current position relative to viewport center
          const rect = falcon.getBoundingClientRect();
          const startX = rect.left + rect.width / 2 - window.innerWidth / 2;
          const startY = rect.top + rect.height / 2 - window.innerHeight / 2;
          
          // Calculate target position (diagonal bottom-left exit)
          const targetX = -window.innerWidth * 0.6;
          const targetY = window.innerHeight * 0.8;
          
          // Animation state object for anime.js to animate
          const animState = {
            translateX: 0,
            translateY: 0,
            translateZ: 0,
            rotateZ: 0,
            rotateY: 0,
            scale: 1,
            opacity: 1
          };
          
          // Function to apply 3D transform
          function applyTransform() {
            falcon.style.transform = 
              `translate3d(${animState.translateX}px, ${animState.translateY}px, ${animState.translateZ}px) ` +
              `rotateZ(${animState.rotateZ}deg) rotateY(${animState.rotateY}deg) ` +
              `scale(${animState.scale})`;
            falcon.style.opacity = animState.opacity;
          }
          
          // Create cinematic timeline animation
          const timeline = window.anime.timeline({
            update: applyTransform,
            complete: function() {
              // Reset position after animation
              setTimeout(function() {
                falcon.style.transform = '';
                falcon.style.transformStyle = '';
                falcon.style.opacity = '1';
                falcon.classList.remove('flying');
                // Reset state
                Object.assign(animState, {
                  translateX: 0,
                  translateY: 0,
                  translateZ: 0,
                  rotateZ: 0,
                  rotateY: 0,
                  scale: 1,
                  opacity: 1
                });
              }, 100);
            }
          });
          
          // Phase 1: Anticipation (slight scale + tilt)
          timeline.add({
            targets: animState,
            scale: [1, 1.15],
            rotateZ: [0, 8],
            rotateY: [0, -10],
            duration: 300,
            easing: 'easeOutQuad'
          });
          
          // Phase 2: Bank and accelerate diagonally (bottom-left)
          timeline.add({
            targets: animState,
            translateX: [0, targetX],
            translateY: [0, targetY],
            translateZ: [0, 800],
            rotateZ: [8, -35],
            rotateY: [-10, -60],
            scale: [1.15, 0.8],
            duration: 800,
            easing: 'easeInExpo'
          });
          
          // Phase 3: Hyperspace entry (shrink, rotate, disappear)
          timeline.add({
            targets: animState,
            translateX: [targetX, targetX * 1.5],
            translateY: [targetY, targetY * 1.2],
            translateZ: [800, 2500],
            rotateZ: [-35, -180],
            rotateY: [-60, -90],
            scale: [0.8, 0.05],
            opacity: [1, 0],
            duration: 900,
            easing: 'easeInExpo'
          });
        });
      });
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initFalconAnimation);
    } else {
      setTimeout(initFalconAnimation, 100);
    }
  })();
</script>

